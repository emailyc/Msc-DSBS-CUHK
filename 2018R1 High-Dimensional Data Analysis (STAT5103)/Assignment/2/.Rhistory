#Coefficients with p-value <= .05
summary(full_model)$coef
summary(full_model)$coef
full_model = lm(data = car, Price ~ .)
car = read.csv(data_url, header = FALSE, sep = "\t", na.strings = c("NaN", "Nan"))
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20180925T131753Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20180925%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=56c4110e507b4f57ee3b77448a5c5902f65e1466438c36f48cb40fd7464c0e83"
car = read.csv(data_url, header = FALSE, sep = "\t", na.strings = c("NaN", "Nan"))
car = car[,-c(3, 4, 13)]
names = c("Price", "Mileage", "Headroom", "Rear", "Trunk", "Weight", "Length", "Turning_diameter", "Displacement", "Gear_ratio")
names(car) = names
summary(car)
full_model = lm(data = car, Price ~ .)
summary(full_model)$coef
#Coefficients with p-value <= .05
summary(full_model)$coef
summary(full_model)$coef[summary(full_model)$coef[,4] <= .05, 4] %>%
formatC(., format = "e", digits = 2) %>%
data.frame("Sigificant Coefficients" = .)
require("knitr")
opts_chunk$set(echo = TRUE, cache=TRUE, message=FALSE, warning = FALSE)
options(width = 100)
require("ggplot2")
require("GGally")
require("dplyr")
#Coefficients with p-value <= .05
summary(full_model)$coef
summary(full_model)$coef[summary(full_model)$coef[,4] <= .05, 4] %>%
formatC(., format = "e", digits = 2) %>%
data.frame("Sigificant Coefficients" = .)
gc()
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20180925T131753Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20180925%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=56c4110e507b4f57ee3b77448a5c5902f65e1466438c36f48cb40fd7464c0e83"
car <- read.csv(data_url, header = FALSE, sep = "\t", na.strings = c("NaN", "Nan"))
getwd()
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20180928T032034Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20180928%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=57b63edf914ed848a854fa182bcf1c4bf9b807639674f94915d3bcd563f89893"
car <- read.csv(data_url, header = FALSE, sep = "\t", na.strings = c("NaN", "Nan"))
car <- car[,-c(3, 4, 13)]
names <- c("Price", "Mileage", "Headroom", "Rear", "Trunk", "Weight", "Length", "Turning_diameter", "Displacement", "Gear_ratio")
names(car) <- names
summary(car)
sum_stat <- psych::describe(car$Price)
sum_stat
null_model <- lm(data = car, Price~1)
anova(null_model, full_model)
full_coef <- paste(round(coef(full_model), 2))
full_model <- lm(data = car, Price ~ .)
full_coef <- paste(round(coef(full_model), 2))
null_model <- lm(data = car, Price~1)
anova(null_model, full_model)
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20180928T032034Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20180928%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=57b63edf914ed848a854fa182bcf1c4bf9b807639674f94915d3bcd563f89893"
car <- read.csv(data_url, header = FALSE, sep = "\t", na.strings = c("NaN", "Nan"))
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20181002T161344Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20181002%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=b5f2467e0e88c05b03254e488ceedcf21dc5e2502a98d262994fc69e0ced30cd"
car <- read.csv(data_url, header = FALSE, sep = "\t", na.strings = c("NaN", "Nan"))
car <- car[,-c(3, 4, 13)]
names <- c("Price", "Mileage", "Headroom", "Rear", "Trunk", "Weight", "Length", "Turning_diameter", "Displacement", "Gear_ratio")
names(car) <- names
summary(car)
my.lm <- function(data, mapping, ...){
p <- ggplot(data = data, mapping = mapping) +
geom_point(size = 3) +
geom_smooth(method = loess, fill = "red", color = "red", size = 3, ...) +
geom_smooth(method = lm, fill = "blue", color = "blue", size = 3, ...)
p
}
g <- ggpairs(
car,
columns = 1:10 ,
upper = list(continuous = wrap("cor", size = 14)),
lower = list( continuous = my.lm)
)
library("knitr")
opts_chunk$set(echo = TRUE, cache=TRUE, message=FALSE, warning = FALSE)
options(width = 100)
library("ggplot2")
library("GGally")
library("dplyr")
my.lm <- function(data, mapping, ...){
p <- ggplot(data = data, mapping = mapping) +
geom_point(size = 3) +
geom_smooth(method = loess, fill = "red", color = "red", size = 3, ...) +
geom_smooth(method = lm, fill = "blue", color = "blue", size = 3, ...)
p
}
g <- ggpairs(
car,
columns = 1:10 ,
upper = list(continuous = wrap("cor", size = 14)),
lower = list( continuous = my.lm)
)
g <- g + ggtitle("Car Dataset Correlation Matrix") +
theme(plot.title = element_text(lineheight = .8,
face = "bold",
size = 40),
axis.title.x = element_text(size = 20))
g
step_model
gc()
rm(list = ls())
library("knitr")
opts_chunk$set(echo = TRUE, cache=TRUE, message=FALSE, warning = FALSE)
options(width = 100)
library("ggplot2")
library("GGally")
library("dplyr")
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20181005T023246Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20181005%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=756d786b3fd347b40e96f0d7e8aee06b7ad402284568de7a246cd07a6876610f"
car <- read.csv(data_url, header = FALSE, sep = "\t", na.strings = c("NaN", "Nan"))
car <- car[,-c(3, 4, 13)]
names <- c("Price", "Mileage", "Headroom", "Rear", "Trunk", "Weight", "Length", "Turning_diameter", "Displacement", "Gear_ratio")
names(car) <- names
summary(car)
my.lm <- function(data, mapping, ...){
p <- ggplot(data = data, mapping = mapping) +
geom_point(size = 3) +
geom_smooth(method = loess, fill = "red", color = "red", size = 3, ...) +
geom_smooth(method = lm, fill = "blue", color = "blue", size = 3, ...)
p
}
g <- ggpairs(
car,
columns = 1:10 ,
upper = list(continuous = wrap("cor", size = 14)),
lower = list( continuous = my.lm)
)
g <- g + ggtitle("Car Dataset Correlation Matrix") +
theme(plot.title = element_text(lineheight = .8,
face = "bold",
size = 40),
axis.title.x = element_text(size = 20))
g
sum_stat <- psych::describe(car$Price)
sum_stat
full_model <- lm(data = car, Price ~ .)
full_coef <- paste(round(coef(full_model), 2))
null_model <- lm(data = car, Price~1)
anova(null_model, full_model)
summary(full_model)$coef
#Coefficients with p-value <= .05
summary(full_model)$coef[summary(full_model)$coef[,4] <= .05, 4] %>%
formatC(., format = "e", digits = 2) %>%
data.frame("Sigificant Coefficients" = .)
library("knitr")
opts_chunk$set(echo = TRUE, cache=TRUE, message=FALSE, warning = FALSE)
options(width = 100)
library("ggplot2")
library("GGally")
library("dplyr")
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20181005T023246Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20181005%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=756d786b3fd347b40e96f0d7e8aee06b7ad402284568de7a246cd07a6876610f"
car <- read.csv(data_url, header = FALSE, sep = "\t", na.strings = c("NaN", "Nan"))
car <- car[,-c(3, 4, 13)]
names <- c("Price", "Mileage", "Headroom", "Rear", "Trunk", "Weight", "Length", "Turning_diameter", "Displacement", "Gear_ratio")
names(car) <- names
summary(car)
step_coef <- paste(round(coef(full_model), 2))
coef(step_coef)
step_coef$coef
summary(step_coef)
model_partial <- lm(data = car, Price ~ . )
step_model <- MASS::stepAIC(model_partial,
direction = "both",
trace = FALSE)
step_model
coef(step_model)
summary(step_model)$coef
summary(step_model)$coef[summary(step_model)$coef[,4] <= .05, 4] %>%
formatC(., format = "e", digits = 2) %>%
data.frame("Sigificant Coefficients" = .)
step_coef <- paste(round(coef(full_model), 2))
step_coef
1.314615e-01
coef(step_model)
hihi = MASS::step(model_partial,
direction = "both",
trace = FALSE)
hihi = MASS::Step(model_partial,
direction = "both",
trace = FALSE)
hihi = step(model_partial,
direction = "both",
trace = FALSE)
summary(step)
summary(hihi)
gc()
rm(list = ls())
library("knitr")
opts_chunk$set(echo = TRUE, cache=TRUE, message=FALSE, warning = FALSE)
options(width = 100)
library("ggplot2")
library("GGally")
library("dplyr")
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20181005T023246Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20181005%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=756d786b3fd347b40e96f0d7e8aee06b7ad402284568de7a246cd07a6876610f"
car <- read.csv(data_url, header = FALSE, sep = "\t", na.strings = c("NaN", "Nan"))
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20181005T132212Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20181005%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=66d546c9727fb21f79f72849055ca2b5b4e84e4e83f7b5388f8fc7055e766e15"
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20181005T132212Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20181005%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=66d546c9727fb21f79f72849055ca2b5b4e84e4e83f7b5388f8fc7055e766e15"
gc()
rm(list = ls())
library("knitr")
opts_chunk$set(echo = TRUE, cache=TRUE, message=FALSE, warning = FALSE)
options(width = 100)
library("ggplot2")
library("GGally")
library("dplyr")
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20181005T132212Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20181005%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=66d546c9727fb21f79f72849055ca2b5b4e84e4e83f7b5388f8fc7055e766e15"
car <- read.csv(data_url, header = FALSE, sep = "\t", na.strings = c("NaN", "Nan"))
car <- car[,-c(3, 4, 13)]
names <- c("Price", "Mileage", "Headroom", "Rear", "Trunk", "Weight", "Length", "Turning_diameter", "Displacement", "Gear_ratio")
names(car) <- names
summary(car)
my.lm <- function(data, mapping, ...){
p <- ggplot(data = data, mapping = mapping) +
geom_point(size = 3) +
geom_smooth(method = loess, fill = "red", color = "red", size = 3, ...) +
geom_smooth(method = lm, fill = "blue", color = "blue", size = 3, ...)
p
}
g <- ggpairs(
car,
columns = 1:10 ,
upper = list(continuous = wrap("cor", size = 14)),
lower = list( continuous = my.lm)
)
g <- g + ggtitle("Car Dataset Correlation Matrix") +
theme(plot.title = element_text(lineheight = .8,
face = "bold",
size = 40),
axis.title.x = element_text(size = 20))
g
sum_stat <- psych::describe(car$Price)
sum_stat
full_model <- lm(data = car, Price ~ .)
full_coef <- paste(round(coef(full_model), 2))
null_model <- lm(data = car, Price~1)
anova(null_model, full_model)
summary(full_model)$coef
#Coefficients with p-value <= .05
summary(full_model)$coef[summary(full_model)$coef[,4] <= .05, 4] %>%
formatC(., format = "e", digits = 2) %>%
data.frame("Sigificant Coefficients" = .)
summary(full_model)$adj.r.squared
model_partial <- lm(data = car, Price ~ . )
step_model <- MASS::stepAIC(model_partial,
direction = "both",
trace = FALSE)
AIC(step_model)
step_coef <- paste(round(coef(step_model), 2))
anova(null_model, step_model)
summary(step_model)$coef
summary(step_model)$coef[summary(step_model)$coef[,4] <= .05, 4] %>%
formatC(., format = "e", digits = 2) %>%
data.frame("Sigificant Coefficients" = .)
summary(step_model)$adj.r.squared
step_model <- step(model_partial,
direction = "both",
trace = FALSE)
AIC(step_model)
step_model <- step(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = FALSE, scope = model_partial )
AIC(step_model)
step_model <- MASS::step(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = FALSE, scope = model_partial )
step_model <- MASS::stepAIC(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = FALSE, scope = model_partial )
AIC(step_model)
step(object = lm(data = car, Price ~ 1 ),
direction = "both", scope = lm(data = car, Price ~ . ) )
stepAIC(object = lm(data = car, Price ~ 1 ),
direction = "both", scope = lm(data = car, Price ~ . ) )
MASS::stepAIC(object = lm(data = car, Price ~ 1 ),
direction = "both", scope = lm(data = car, Price ~ . ) )
step_model <- MASS::stepAIC(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = FALSE,
scope = full_model)
AIC(step_model)
step_model <- MASS::stepAIC(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = FALSE,
scope = full_model)
AIC(step_model)
step_model <- step(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = FALSE,
scope = full_model)
AIC(step_model)
step_model <- MASS::stepAIC(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = FALSE,
scope = lm(data = car, Price ~ . ))
AIC(step_model)
step_model <- MASS::stepAIC(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = TRUE,
scope = lm(data = car, Price ~ . ))
AIC(step_model)
library("knitr")
opts_chunk$set(echo = TRUE, cache=TRUE, message=FALSE, warning = FALSE)
options(width = 100)
library("ggplot2")
library("GGally")
library("dplyr")
data_url = "https://s3-ap-southeast-1.amazonaws.com/learn-ap-southeast-1-prod-fleet02-xythos/593a61e7aa84f/3406258?response-content-disposition=inline%3B%20filename%2A%3DUTF-8%27%27carc.txt&response-content-type=text%2Fplain&X-Amz-Algorithm=AWS4-HMAC-SHA256&X-Amz-Date=20181005T132212Z&X-Amz-SignedHeaders=host&X-Amz-Expires=21600&X-Amz-Credential=AKIAJDDBGKVKR5QVHNHA%2F20181005%2Fap-southeast-1%2Fs3%2Faws4_request&X-Amz-Signature=66d546c9727fb21f79f72849055ca2b5b4e84e4e83f7b5388f8fc7055e766e15"
car <- read.csv(data_url, header = FALSE, sep = "\t", na.strings = c("NaN", "Nan"))
car <- car[,-c(3, 4, 13)]
names <- c("Price", "Mileage", "Headroom", "Rear", "Trunk", "Weight", "Length", "Turning_diameter", "Displacement", "Gear_ratio")
names(car) <- names
summary(car)
step_model <- MASS::stepAIC(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = TRUE,
scope = lm(data = car, Price ~ . ))
AIC(step_model)
step_model <- step(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = TRUE,
scope = lm(data = car, Price ~ . ))
AIC(step_model)
full_model <- lm(data = car, Price ~ .)
step_model <- step(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = TRUE,
scope = full_model)
AIC(step_model)
step_model <- step(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = TRUE,
scope = formula(full_model))
step_model <- step(object = lm(data = car, Price ~ 1 ),
direction = "both",
trace = FALSE,
scope = formula(full_model))
AIC(step_model)
step_model <- step(object = formula(null_model),
direction = "both",
trace = FALSE,
scope = formula(full_model))
null_model <- lm(data = car, Price~1)
anova(null_model, full_model)
step_model <- step(object = formula(null_model),
direction = "both",
trace = FALSE,
scope = formula(full_model))
step_model <- step(object = null_model,
direction = "both",
trace = FALSE,
scope = formula(full_model))
step_model <- step(object = null_model,
direction = "both",
trace = T,
scope = formula(full_model))
step_model <- MASS::stepAIC(object = null_model,
direction = "both",
trace = T,
scope = formula(full_model))
AIC(step_model)
AIC(step_model, k = 1000)
AIC(step_model, k = 1)
step_model <- MASS::stepAIC(object = full_model,
direction = "both",
trace = FALSE)
step_model <- MASS::stepAIC(object = full_model,
direction = "both",
trace = T)
extractAIC(step_model)
extractAIC(step_model)
extractAIC(step_model)[2]
extractAIC(step_model) - extractAIC(null_model)
extractAIC(step_model)[2] - extractAIC(null_model)[2]
AIC(step_model)[2] - AIC(null_model)[2]
AIC(step_model) - AIC(null_model)
extractAIC(null_model)
extractAIC.lm(step_model)
extractAIC(step_model).lm
hihi = extractAIC(step_model)
hihi
