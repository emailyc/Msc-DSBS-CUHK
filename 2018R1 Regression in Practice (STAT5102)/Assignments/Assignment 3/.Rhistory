p1<-p1+ggtitle("Residual vs Fitted Plot")+theme_bw()
p2
log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
p2<-ggplot(log_a, aes(.fitted, .resid)) + geom_point()
p1<-p1+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p1<-p1+xlab("Fitted values")+ylab("Residuals")
p1<-p1+ggtitle("Residual vs Fitted Plot")+theme_bw()
p2
log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
p2<-ggplot(log_a, aes(.fitted, .resid)) + geom_point()
p2<-p2+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p2<-p2+xlab("Fitted values")+ylab("Residuals")
p2<-p2+ggtitle("Residual vs Fitted Plot")+theme_bw()
p2
log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
p2<-ggplot(log_a, aes(.fitted, .resid)) + geom_point()
p2<-p2+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p2<-p2+xlab("Fitted values")+ylab("Residuals")
p2<-p2+ggtitle("Residual vs Fitted Plot")+theme_bw()
p2
log_b <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)))
p3<-ggplot(log_a, aes(.fitted, .resid)) + geom_point()
p3<-p3+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p3<-p3+xlab("Fitted values")+ylab("Residuals")
p3<-p3+ggtitle("Residual vs Fitted Plot")+theme_bw()
p3
log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
p2<-ggplot(log_a, aes(.fitted, .resid)) + geom_point()
p2<-p2+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p2<-p2+xlab("Fitted values")+ylab("Residuals")
p2<-p2+ggtitle("Residual vs Fitted Plot")+theme_bw()
p2
log_b <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)))
p3<-ggplot(log_b, aes(.fitted, .resid)) + geom_point()
p3<-p3+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p3<-p3+xlab("Fitted values")+ylab("Residuals")
p3<-p3+ggtitle("Residual vs Fitted Plot")+theme_bw()
p3
model_log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
bc <- MASS::boxcox(model_a, plotit = FALSE)
best_lm <- bc$x[which(bc$y == max(bc$y))]
best_lm
log_a <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)))
p3<-ggplot(log_a, aes(.fitted, .resid)) + geom_point()
p3<-p3+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p3<-p3+xlab("Fitted values")+ylab("Residuals")
p3<-p3+ggtitle("Residual vs Fitted Plot")+theme_bw()
p3
model_log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
bc <- MASS::boxcox(model_log_a, plotit = FALSE)
best_lm <- bc$x[which(bc$y == max(bc$y))]
best_lm
log_a <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)))
p3<-ggplot(log_a, aes(.fitted, .resid)) + geom_point()
p3<-p3+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p3<-p3+xlab("Fitted values")+ylab("Residuals")
p3<-p3+ggtitle("Residual vs Fitted Plot")+theme_bw()
p3
bc
best_lm
model_log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
bc <- MASS::boxcox(model_log_a, plotit = FALSE)
best_lm <- bc$x[which(bc$y == max(bc$y))]
best_lm
log_a <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)))
p3<-ggplot(log_a, aes(.fitted, .resid)) + geom_point()
p3<-p3+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p3<-p3+xlab("Fitted values")+ylab("Residuals")
p3<-p3+ggtitle("Residual vs Fitted Plot")+theme_bw()
p3
bc
model_a <- lm(fevdata$fev ~ fevdata$age)
bc <- MASS::boxcox(model_a, plotit = FALSE)
best_lm <- bc$x[which(bc$y == max(bc$y))]
best_lm
model_a <- lm(fevdata$fev ~ fevdata$age)
library("knitr")
opts_chunk$set(echo = TRUE, cache=TRUE, message=FALSE, warning = FALSE)
options(width = 100)
library("ggplot2")
library("GGally")
library("dplyr")
fevdata <- read.csv("fevdata.txt", header = TRUE, sep = "")
HAMILTON <- read.csv("HAMILTON.txt", header = TRUE, sep = "\t")
levels(fevdata$sex) <- c(0,1)
levels(fevdata$smoke) <- c(0,1)
model_a <- lm(fevdata$fev ~ fevdata$age)
bc <- MASS::boxcox(model_a, plotit = FALSE)
best_lm <- bc$x[which(bc$y == max(bc$y))]
best_lm
model_b <- lm(I(log(fevdata$fev)) ~ fevdata$age)
p1<-ggplot(model_b, aes(.fitted, .resid)) + geom_point()
p1<-p1+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p1<-p1+xlab("Fitted values")+ylab("Residuals")
p1<-p1+ggtitle("Residual vs Fitted Plot")+theme_bw()
p1
model_b <- lm(I(fevdata$fev^.2) ~ fevdata$age)
p1<-ggplot(model_b, aes(.fitted, .resid)) + geom_point()
p1<-p1+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p1<-p1+xlab("Fitted values")+ylab("Residuals")
p1<-p1+ggtitle("Residual vs Fitted Plot")+theme_bw()
p1
model_b <- lm(I(log(fevdata$fev)) ~ fevdata$age)
p1<-ggplot(model_b, aes(.fitted, .resid)) + geom_point()
p1<-p1+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p1<-p1+xlab("Fitted values")+ylab("Residuals")
p1<-p1+ggtitle("Residual vs Fitted Plot")+theme_bw()
p1
model_b.fitted
View(fevdata$age)
model_b.resid
model_b <- lm(I(log(fevdata$fev)) ~ fevdata$age)
p1<-ggplot(model_b, aes(fevdata$age, .resid)) + geom_point()
p1<-p1+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p1<-p1+xlab("Fitted values")+ylab("Residuals")
p1<-p1+ggtitle("Residual vs Fitted Plot")+theme_bw()
p1
resid(model_b)
model_b <- lm(I(log(fevdata$fev)) ~ fevdata$age)
p1<-ggplot(model_b, aes(fevdata$age, resid(model_b))) + geom_point()
p1<-p1+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p1<-p1+xlab("Fitted values")+ylab("Residuals")
p1<-p1+ggtitle("Residual vs Fitted Plot")+theme_bw()
p1
model_log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
bc <- MASS::boxcox(model_log_a, plotit = FALSE)
best_lm <- bc$x[which(bc$y == max(bc$y))]
best_lm
log_a <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)))
p3<-ggplot(log_a, aes(.fitted, .resid)) + geom_point()
p3<-p3+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p3<-p3+xlab("Fitted values")+ylab("Residuals")
p3<-p3+ggtitle("Residual vs Fitted Plot")+theme_bw()
p3
model_log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
bc <- MASS::boxcox(model_log_a, plotit = FALSE)
best_lm <- bc$x[which(bc$y == max(bc$y))]
best_lm
log_a <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)))
p3<-ggplot(log_a, aes(log(fevdata$age), resid(log_a))) + geom_point()
p3<-p3+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p3<-p3+xlab("Fitted values")+ylab("Residuals")
p3<-p3+ggtitle("Residual vs Fitted Plot")+theme_bw()
p3
model_log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
bc <- MASS::boxcox(model_log_a, plotit = FALSE)
best_lm <- bc$x[which(bc$y == max(bc$y))]
best_lm
log_a <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)))
p3<-ggplot(log_a, aes(log(fevdata$age), resid(log_a))) + geom_point()
p3<-p3+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p3<-p3+xlab("log(age)")+ylab("Residuals")
p3<-p3+ggtitle("Residual vs log(age)")+theme_bw()
p3
model_log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
bc <- MASS::boxcox(model_log_a, plotit = FALSE)
best_lm <- bc$x[which(bc$y == max(bc$y))]
best_lm
log_a <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)))
p3<-ggplot(log_a, aes(log(fevdata$age), resid(log_a))) + geom_point()
p3<-p3+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p3<-p3+xlab("log(age)")+ylab("Residuals")
p3<-p3+ggtitle("Residual vs log(age)")+theme_bw()
p3
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
summary(model_d)
model_log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
bc <- MASS::boxcox(model_log_a, plotit = FALSE)
best_lm <- bc$x[which(bc$y == max(bc$y))]
best_lm
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .redid)) + geom_point()
p3<-p3+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p3<-p3+xlab("log(age)")+ylab("Residuals")
p3<-p3+ggtitle("Residual vs log(age)")+theme_bw()
p4
model_log_a <- lm(fevdata$fev ~ I(log(fevdata$age)))
bc <- MASS::boxcox(model_log_a, plotit = FALSE)
best_lm <- bc$x[which(bc$y == max(bc$y))]
best_lm
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p3<-p3+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p3<-p3+xlab("log(age)")+ylab("Residuals")
p3<-p3+ggtitle("Residual vs log(age)")+theme_bw()
p4
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("log(age)")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs log(age)")+theme_bw()
p4
range(log(fevdata$fev))
model_b <- lm(I(log(fevdata$fev)) ~ fevdata$age)
p1<-ggplot(model_b, aes(fevdata$age, resid(model_b))) + geom_point()
p1<-p1+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p1<-p1+xlab("Age")+ylab("Residuals")
p1<-p1+ggtitle("Residual vs Age")+theme_bw()
p1
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
p5<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p5<-p5+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p5<-p5+xlab("Fitted value")+ylab("Residuals")
p5<-p5+ggtitle("Residual vs Fitted")+theme_bw()
cowplot::plot_grid(p4, p5, ncol = 2, nrow = 1)
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
p5<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p5<-p5+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p5<-p5+xlab("Fitted value")+ylab("Residuals")
p5<-p5+ggtitle("Residual vs Fitted log(ht)")+theme_bw()
cowplot::plot_grid(p4, p5, ncol = 2, nrow = 1)
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
p5<-ggplot(model_d_log, aes(.fitted, .resid)) + geom_point()
p5<-p5+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p5<-p5+xlab("Fitted value")+ylab("Residuals")
p5<-p5+ggtitle("Residual vs Fitted log(ht)")+theme_bw()
cowplot::plot_grid(p4, p5, ncol = 2, nrow = 1)
summary(model_d)
coef(model_d)
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
p5<-ggplot(model_d_log, aes(.fitted, .resid)) + geom_point()
p5<-p5+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p5<-p5+xlab("Fitted value")+ylab("Residuals")
p5<-p5+ggtitle("Residual vs Fitted log(ht)")+theme_bw()
cowplot::plot_grid(p4, p5, ncol = 2, nrow = 1)
library("knitr")
opts_chunk$set(echo = TRUE, cache=TRUE, message=FALSE, warning = FALSE)
options(width = 100)
library("ggplot2")
library("GGally")
library("dplyr")
confint(model_d)
CI <- confint(model_d)
CI
CI[1,1]
exp(-2.29651917)
exp(-2.04457606)
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
residuals = log(fevdata$fev)) - coef(model_d)[1] - coef(model_d)[2] * log(fevdata$age) - coef(model_d)[2] * log(fevdata$ht)
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
residuals = log(fevdata$fev) - coef(model_d)[1] - coef(model_d)[2] * log(fevdata$age) - coef(model_d)[2] * log(fevdata$ht)
p5<-ggplot(model_d_log, aes(.fitted, residuals)) + geom_point()
p5<-p5+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p5<-p5+xlab("Fitted value")+ylab("Residuals")
p5<-p5+ggtitle("Residual vs Fitted log(ht)")+theme_bw()
cowplot::plot_grid(p4, p5, ncol = 2, nrow = 1)
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
residuals = log(fevdata$fev) - coef(model_d_log)[1] - coef(model_d_log)[2] * log(fevdata$age) - coef(model_d_log)[2] * log(fevdata$ht)
p5<-ggplot(model_d_log, aes(.fitted, residuals)) + geom_point()
p5<-p5+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p5<-p5+xlab("Fitted value")+ylab("Residuals")
p5<-p5+ggtitle("Residual vs Fitted log(ht)")+theme_bw()
cowplot::plot_grid(p4, p5, ncol = 2, nrow = 1)
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
residuals = log(fevdata$fev) - coef(model_d)[1] - coef(model_d)[2] * log(fevdata$age) - coef(model_d)[2] * log(fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
residuals = log(fevdata$fev) - coef(model_d_log)[1] - coef(model_d_log)[2] * log(fevdata$age) - coef(model_d_log)[2] * log(fevdata$ht)
p5<-ggplot(model_d_log, aes(.fitted, residuals)) + geom_point()
p5<-p5+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p5<-p5+xlab("Fitted value")+ylab("Residuals")
p5<-p5+ggtitle("Residual vs Fitted log(ht)")+theme_bw()
cowplot::plot_grid(p4, p5, ncol = 2, nrow = 1)
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
residuals = log(fevdata$fev) - coef(model_d)[1] - coef(model_d)[2] * log(fevdata$age) - coef(model_d)[2] * log(fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, residuals)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
residuals = log(fevdata$fev) - coef(model_d_log)[1] - coef(model_d_log)[2] * log(fevdata$age) - coef(model_d_log)[2] * log(fevdata$ht)
p5<-ggplot(model_d_log, aes(.fitted, residuals)) + geom_point()
p5<-p5+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p5<-p5+xlab("Fitted value")+ylab("Residuals")
p5<-p5+ggtitle("Residual vs Fitted log(ht)")+theme_bw()
cowplot::plot_grid(p4, p5, ncol = 2, nrow = 1)
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
residuals = model_d$fitted.values - coef(model_d)[1] - coef(model_d)[2] * log(fevdata$age) - coef(model_d)[2] * log(fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, residuals)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
residuals = model_d_log$fitted.values - coef(model_d_log)[1] - coef(model_d_log)[2] * log(fevdata$age) - coef(model_d_log)[2] * log(fevdata$ht)
p5<-ggplot(model_d_log, aes(.fitted, residuals)) + geom_point()
p5<-p5+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p5<-p5+xlab("Fitted value")+ylab("Residuals")
p5<-p5+ggtitle("Residual vs Fitted log(ht)")+theme_bw()
cowplot::plot_grid(p4, p5, ncol = 2, nrow = 1)
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
residuals = model_d$fitted.values - coef(model_d)[1] - coef(model_d)[2] * log(fevdata$age) - coef(model_d)[2] * log(fevdata$ht)
p4<-ggplot(model_d, aes(model_d$fitted.values, residuals)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
residuals = model_d_log$fitted.values - coef(model_d_log)[1] - coef(model_d_log)[2] * log(fevdata$age) - coef(model_d_log)[2] * log(fevdata$ht)
p5<-ggplot(model_d_log, aes(.fitted, residuals)) + geom_point()
p5<-p5+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p5<-p5+xlab("Fitted value")+ylab("Residuals")
p5<-p5+ggtitle("Residual vs Fitted log(ht)")+theme_bw()
cowplot::plot_grid(p4, p5, ncol = 2, nrow = 1)
model_d <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + fevdata$ht)
p4<-ggplot(model_d, aes(.fitted, .resid)) + geom_point()
p4<-p4+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p4<-p4+xlab("Fitted value")+ylab("Residuals")
p4<-p4+ggtitle("Residual vs Fitted")+theme_bw()
model_d_log <- lm(I(log(fevdata$fev)) ~ I(log(fevdata$age)) + I(log(fevdata$ht)))
p5<-ggplot(model_d_log, aes(.fitted, .resid)) + geom_point()
p5<-p5+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p5<-p5+xlab("Fitted value")+ylab("Residuals")
p5<-p5+ggtitle("Residual vs Fitted log(ht)")+theme_bw()
cowplot::plot_grid(p4, p5, ncol = 2, nrow = 1)
model_b <- lm(log(fevdata$fev) ~ fevdata$age)
p1<-ggplot(model_b, aes(fevdata$age, resid(model_b))) + geom_point()
p1<-p1+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p1<-p1+xlab("Age")+ylab("Residuals")
p1<-p1+ggtitle("Residual vs Age")+theme_bw()
p1
model_b <- lm(I(log(fevdata$fev)) ~ fevdata$age)
p1<-ggplot(model_b, aes(fevdata$age, resid(model_b))) + geom_point()
p1<-p1+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p1<-p1+xlab("Age")+ylab("Residuals")
p1<-p1+ggtitle("Residual vs Age")+theme_bw()
p1
logged_fev <- log(fevdata$fev)
model_b <- lm(logged_fev ~ fevdata$age)
p1<-ggplot(model_b, aes(fevdata$age, resid(model_b))) + geom_point()
p1<-p1+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p1<-p1+xlab("Age")+ylab("Residuals")
p1<-p1+ggtitle("Residual vs Age")+theme_bw()
p1
model_b <- lm(I(log(fevdata$fev)) ~ fevdata$age)
p1<-ggplot(model_b, aes(fevdata$age, resid(model_b))) + geom_point()
p1<-p1+stat_smooth(method="loess")+geom_hline(yintercept=0, col="red", linetype="dashed")
p1<-p1+xlab("Age")+ylab("Residuals")
p1<-p1+ggtitle("Residual vs Age")+theme_bw()
p1
cor(HAMILTON$Y, HAMILTON$X2)
cor(HAMILTON$Y, HAMILTON$X1)
cor(HAMILTON$Y, HAMILTON$X2)
b = lm(HAMILTON$Y ~ HAMILTON$X2 + HAMILTON$X1)
r.squared(b)
plm::r.squared(b)
install.packages("plm")
plm::r.squared(b)
summary(b)
c = lm(HAMILTON$Y ~ HAMILTON$X2 + HAMILTON$X1)
plot(c)
c = lm(HAMILTON$Y ~ HAMILTON$X2 + HAMILTON$X1)
c$r.squared
c = lm(HAMILTON$Y ~ HAMILTON$X2 + HAMILTON$X1)
summary(c)$r.squared
library("knitr")
opts_chunk$set(echo = TRUE, cache=TRUE, message=FALSE, warning = FALSE)
options(width = 100)
library("ggplot2")
library("GGally")
library("dplyr")
plot(c)
par(mfrow=c(2,2))
plot(c)
cor(HAMILTON$X2, HAMILTON$X1)
plot(c$residuals, pnorm(c$residuals))
vif(c)
car::vif(c)
basketball = read.csv("Basketball.txt")
View(basketball)
basketball = basketball[,c("X.1", "AST")]
mylogit <- glm(AST ~ X.1, data = basketball, family = "binomial")
stringr::str_replace_all(basketball$X.1, "^W", 1)
basketball$X.1[which(basketball$X.1e=="^W")] <- 1
which(basketball$X.1e=="^W")
which(basketball$X.1=="^W")
grep(basketball$X.1, "^W")
which(grep(basketball$X.1, "^W"))
basketball$X.1 <- sub("^W.*", 1, basketball$X.1)
basketball$X.1 <- sub("^L.*", 0, basketball$X.1)
mylogit <- glm(AST ~ X.1, data = basketball, family = "binomial")
class(basketball$X.1)
basketball$X.1 = as.numeric(basketball$X.1)
mylogit <- glm(AST ~ X.1, data = basketball, family = "binomial")
class(basketball$X.1)
unique(basketball$X.1)
class(AST)
mylogit <- glm(X.1 ~ AST, data = basketball, family = "binomial")
summary(mylogit)
fevdata <- read.csv("fevdata.txt", header = TRUE, sep = "")
HAMILTON <- read.csv("HAMILTON.txt", header = TRUE, sep = "\t")
basketball = read.csv("Basketball.txt")
levels(fevdata$sex) <- c(0,1)
levels(fevdata$smoke) <- c(0,1)
fevdata <- read.csv("fevdata.txt", header = TRUE, sep = "")
HAMILTON <- read.csv("HAMILTON.txt", header = TRUE, sep = "\t")
basketball = read.csv("Basketball.txt")
colnames(basketball$X.1) <- "Win"
fevdata <- read.csv("fevdata.txt", header = TRUE, sep = "")
HAMILTON <- read.csv("HAMILTON.txt", header = TRUE, sep = "\t")
basketball = read.csv("Basketball.txt")
names(basketball$X.1) <- "Win"
levels(fevdata$sex) <- c(0,1)
levels(fevdata$smoke) <- c(0,1)
fevdata <- read.csv("fevdata.txt", header = TRUE, sep = "")
HAMILTON <- read.csv("HAMILTON.txt", header = TRUE, sep = "\t")
basketball = read.csv("Basketball.txt")
names(basketball$X.1) <- "Win"
levels(fevdata$sex) <- c(0,1)
levels(fevdata$smoke) <- c(0,1)
names(basketball$X.1)
fevdata <- read.csv("fevdata.txt", header = TRUE, sep = "")
HAMILTON <- read.csv("HAMILTON.txt", header = TRUE, sep = "\t")
basketball = read.csv("Basketball.txt")
rename(basketball, "Win", "X.1")
fevdata <- read.csv("fevdata.txt", header = TRUE, sep = "")
HAMILTON <- read.csv("HAMILTON.txt", header = TRUE, sep = "\t")
basketball = read.csv("Basketball.txt")
names(basketball)[names(basketball) == 'X.1'] <- 'Win'
levels(fevdata$sex) <- c(0,1)
levels(fevdata$smoke) <- c(0,1)
rena
basketball$Win <- sub("^W.*", 1, basketball$X.1)
head(basketball)
basketball$Win <- sub("^W.*", 1, basketball$Win)
basketball$Win <- sub("^L.*", 0, basketball$Win)
basketball$Win = as.numeric(basketball$Win)
basketball$Win <- sub("^W.*", 1, basketball$Win)
basketball$Win <- sub("^L.*", 0, basketball$Win)
basketball$Win = as.numeric(basketball$Win)
logit_model <- glm(Win ~ AST, data = basketball, family = "binomial")
logit_model
basketball$Win <- sub("^W.*", 1, basketball$Win)
basketball$Win <- sub("^L.*", 0, basketball$Win)
basketball$Win = as.numeric(basketball$Win)
logit_model <- glm(Win ~ AST, data = basketball, family = "binomial")
coef(logit_model)
predict(logit_model, new <- data.frame(x = c(3, 24)))
predict(logit_model, new <- data.frame(AST = c(3, 24)))
range(basketball$AST)
predict(logit_model)
predict(logit_model, new <- data.frame(AST = c(3, 24)), type="response")
#predict(logit_model, new <- data.frame(AST = c(3, 24)), type="response")
result <- predict(logit_model)
min(result)
#predict(logit_model, new <- data.frame(AST = c(3, 24)), type="response")
result <- predict(logit_model,type="response")
min(result)
predict(logit_model, new <- data.frame(AST = c(3, 24)), type="model term")
predict(logit_model, new <- data.frame(AST = c(3, 24)), type="terms")
predict(logit_model, new <- data.frame(AST = c(3, 24)), type="response")
confint(logit_model)
predict(logit_model, newdata = data.frame(AST = c(3, 24)), type="response")
predict(logit_model, newdata = data.frame(AST = c(3, 24)), type="response")
basketball$Win <- sub("^W.*", 1, basketball$Win)
basketball$Win <- sub("^L.*", 0, basketball$Win)
basketball$Win = as.numeric(basketball$Win)
logit_model <- glm(Win ~ AST, data = basketball, family = binomial(link="logit"))
coef(logit_model)
predict(logit_model, newdata = data.frame(AST = c(3, 24)), type="response")
install.packages("survey")
survey::regTermTest(logit_model, Win)
survey::regTermTest(logit_model, "Win")
survey::regTermTest(logit_model, "AST")
exp(confint(logit_model))
exp(0.1441563)
confint.default(logit_model)
exp(confint.default(logit_model))
MASS::exp(confint.default(logit_model))
MASS::exp(MASS::confint.default(logit_model))
exp(MASS::confint.default(logit_model))
exp(MASS::confint.profile.glm(logit_model))
exp(MASS::confint-MASS(logit_model))
exp(MASS::confint(logit_model))
exp(confint(logit_model))
exp(confint.default(logit_model))
